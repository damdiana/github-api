(()=>{"use strict";function e(e){return new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}let n=document.querySelector("form");if(null===n){let e="There's no form in the page!";throw alert(e),new Error(e)}let t=document.querySelector(".details-dialog");if(null===t){let e="There's no dialog in the page!";throw alert(e),new Error(e)}let a=t.querySelector(".details-dialog__content__dynamic"),s=document.querySelector("#dinamicContent"),l=document.querySelector(".skeleton-screen");function i(e,n,t,a,s,l){let i=document.createElement("footer");i.classList.add("text-center"),i.innerHTML=`\n        ${!0===e?"<button class='btn btn-navy' id='prev-issue-button'> <i class='fa-solid fa-angles-left'></i> Prev </button>":""}\n       <span class="page-number"> ${s} </span>\n        ${!0===n?"<button class='btn btn-navy' id='next-issue-button'> Next <i class='fa-solid fa-angles-right'></i> </button>":""}\n        `;let r=i.querySelector("#prev-issue-button"),o=i.querySelector("#next-issue-button");null!==r&&r.addEventListener("click",t),null!==o&&o.addEventListener("click",a),l.appendChild(i)}function r(e,n){let t=document.createElement("p");t.innerText=e,t.classList.add(n),null!==s&&s.appendChild(t)}function o(e){e.innerHTML='<div class="loader">\n    <div class="spinner"></div>\n  </div>'}async function c(n,t,a,s,l){let r=n.querySelector(".issue-container");if(null===r)throw new Error("Tried rendering issues but found no parent where to insert them.");o(r);let d=await async function(e,n,t,a){let s=await fetch(`https://api.github.com/repos/${e}/${n}/issues?state=all&per_page=${t}&page=${a}`),l=s.headers.get("link"),i=null!==l&&l.includes('rel="next"'),r=null!==l&&l.includes('rel="prev"');return s.ok?{ok:!0,issues:await s.json(),hasNextPage:i,hasPreviousPage:r}:{ok:!1,message:(await s.json()).message}}(t,a,s,l);!0===d.ok?(function(n,t){if(t.innerHTML="",0!==n.length){let a=document.createElement("ul");[...n].sort(((e,n)=>{let t=new Date(e.created_at).getTime();return new Date(n.created_at).getTime()-t})).forEach((n=>{let t=document.createElement("li");t.classList.add("list-none","mt-4"),t.innerHTML=`\n        <div class="dialog-background"> \n        <a href='${n.html_url}' target='_blank' class="title-hover">\n            <span class="text-bold">\n            👉🏻 Title:\n            </span>\n            <span class="issue-title"></span>\n        </a>\n        <p> <span class="text-bold"> 🚀 Type: </span> ${n.hasOwnProperty("pull_request")?"Pull Request":"Issue"} </p>  \n        <p> <span class="text-bold"> 📅 Created at:</span> ${e(new Date(n.created_at))} </p>\n        <p> <span class="text-bold"> 🛠️ State:</span> ${n.state} </p> \n        ${null!==n.assignee?`\n        <p> <span class="text-bold"> 👨🏻‍💻 Assignee:</span> ${n.assignee.login} </p>`:""}\n        <p> <span class="text-bold"> 🕥 Last updated:</span> ${e(new Date(n.updated_at))} </p>\n        <p> <span class="text-bold"> ✅ Closed at:</span> ${e(new Date(n.closed_at))} </p> \n        </div> \n        `;let s=t.querySelector(".issue-title");null!==s&&(s.innerText=n.title),a.appendChild(t)})),t.appendChild(a)}else t.innerHTML='\n        <div class="dialog-background mt-4"> \n        <p class="text-center"> There are no issues for this repo 🤷🏻‍♂️ </p>\n        </div>\n        '}(d.issues,r),i(d.hasPreviousPage,d.hasNextPage,(()=>c(n,t,a,s,l-1)),(()=>c(n,t,a,s,l+1)),l,r)):r.innerHTML=`<p>${d.message} </p>`}async function d(n,t,a,s,l){let r=n.querySelector(".issue-container");if(null===r)throw new Error("Tried rendering issues but found no parent where to insert them.");o(r);let c=await async function(e,n,t,a){let s=await fetch(`https://api.github.com/repos/${e}/${n}/commits?per_page=${t}&page=${a}`),l=s.headers.get("link"),i=null!==l&&l.includes('rel="next"'),r=null!==l&&l.includes('rel="prev"');return s.ok?{ok:!0,commits:await s.json(),hasNextPage:i,hasPreviousPage:r}:{ok:!1,message:(await s.json()).message}}(t,a,s,l);!0===c.ok?(function(n,t){t.innerHTML="";let a=document.createElement("ul");[...n].sort(((e,n)=>{let t=new Date(e.commit.author.date).getTime();return new Date(n.commit.author.date).getTime()-t})).forEach((n=>{let t=document.createElement("li");t.classList.add("list-none","mt-4"),t.innerHTML=`\n        <div class="dialog-background"> \n            <a href='${n.html_url}' target='_blank' class="title-hover">\n                <span class="text-bold">\n                👉🏻 Title:\n                </span>\n                <span class="commit-title"></span>\n            </a>\n            <p> <span class="text-bold"> 👩🏻‍💻 Author: </span> ${n.commit.author.name} </p>\n            <p> <span class="text-bold"> 📅 Date: </span> ${e(new Date(n.commit.author.date))} </p>\n        </div>\n        `;let s=t.querySelector(".commit-title");null!==s&&(s.innerText=n.commit.message,console.log(n)),a.appendChild(t)})),t.appendChild(a)}(c.commits,r),i(c.hasPreviousPage,c.hasNextPage,(()=>d(n,t,a,s,l-1)),(()=>d(n,t,a,s,l+1)),l,r)):r.innerHTML=`<p>${c.message} </p>`}t.addEventListener("click",(e=>{e.target===t&&e.target.close()})),n.addEventListener("submit",(async function(e){e.preventDefault(),null!==s&&(s.innerHTML=""),null!==l&&l.classList.toggle("hidden");try{let n=await async function(e){let n=await fetch(`https://api.github.com/users/${e}/repos`);return n.ok?{ok:!0,repos:(await n.json()).filter((e=>!1===e.private))}:{ok:!1,message:(await n.json()).message}}(e.currentTarget.username.value);n.ok?function(e){let n=document.createElement("ul");n.classList.add("repo-list"),e.forEach((e=>{let s=document.createElement("li");s.classList.add("repo-card"),s.innerHTML=`\n        <a href="${e.html_url}" class="repo-link"> ${e.name} </a>\n        <div class="repo-details__display mt-2">\n            ${null!==e.language?`\n            <div class="flex align-center">\n                    <span class="lng-badge lng-badge-${e.language}"> </span>\n                    <p class="text-sm m-1"> ${e.language} </p>\n            </div>\n            `:"<div> </div>"}\n            <div class="flex align-center">\n                <a href="https://github.com/${e.owner.login}/${e.name}/stargazers" type="button">\n                <i class="fa-regular fa-star"></i>\n                    <span class="text-sm m-1"> ${e.stargazers_count} </span>\n                </a>\n            </div>\n            <div class="flex align-center">\n                <a href="https://github.com/${e.owner.login}/${e.name}/network/members">\n                <i class="fa-solid fa-code-fork"></i>\n                <span class="text-sm m-1"> ${e.forks_count} </span>\n                </a>\n            </div> \n            <div class="text-center"> \n                <button class="repo-card__details-btn btn btn-navy">Details</button>\n            </div>\n            </div>       \n        `;let l=s.querySelector(".repo-card__details-btn");null!==l&&l.addEventListener("click",(()=>{!async function(e){null!==a&&(a.innerHTML=`\n        <h2 class="text-center"> ${e.name} </h2>\n        <div class="dialog__repo-card flex flex-wrap justify-around">\n            <p class="m-0"> \n            <span class="text-bold"> Owner: </span> ${e.owner.login} </p>\n            ${null!==e.language?`\n                <div class="flex align-center">\n                   <p class="m-0"> \n                   <span class="text-bold"> Language</span>: ${e.language} </p>\n                </div>\n            `:""}\n        <div class="flex align-center">\n                <a href="https://github.com/${e.owner.login}/${e.name}/stargazers" type="button">\n                <span class="text-bold"> Stars: </span>\n                <span> ${e.stargazers_count} </span>\n            </a>\n        </div>\n        <div class="flex align-center">\n                <a href="https://github.com/${e.owner.login}/${e.name}/network/members">\n                <span class="text-bold"> Forks: </span>\n                <span"> ${e.forks_count} </span>\n            </a>\n        </div>\n        </div>\n        <div class="tabs flex"> \n            <button id="btn-issues" class="btn tab tab--active "> Issues </button>\n            <button id="btn-commits" class="btn tab"> Commits </button>\n        </div>\n        <div class="issue-container">\n        </div>\n        `),null!==t&&(t.showModal(),c(t,e.owner.login,e.name,5,1),function(e,n,t,a){let s=document.querySelector("#btn-issues"),l=document.querySelector("#btn-commits");null!==l&&l.addEventListener("click",(()=>{l?.classList.contains("tab--active")||(l?.classList.add("tab--active"),s?.classList.remove("tab--active"),d(e,n,t,5,1))})),null!==s&&s.addEventListener("click",(()=>{s?.classList.contains("tab--active")||(s?.classList.add("tab--active"),l?.classList.remove("tab--active"),c(e,n,t,5,1))}))}(t,e.owner.login,e.name))}(e)})),n.appendChild(s)})),null!==s&&s.appendChild(n)}(n.repos):r(n.message,"textWarning")}catch(e){console.log(e),r("Something went wrong. Refresh and try again!","textError")}null!==l&&l.classList.toggle("hidden")}))})();